<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Programirajmo u R-u - old</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="Udžbenik za vještinu ‘Osnove programskog jezika R’ na Fakultetu elektrotehnike i računarstva, Sveučilište u Zagrebu.">
  <meta name="generator" content="bookdown 0.3 and GitBook 2.6.7">

  <meta property="og:title" content="Programirajmo u R-u - old" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Udžbenik za vještinu ‘Osnove programskog jezika R’ na Fakultetu elektrotehnike i računarstva, Sveučilište u Zagrebu." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Programirajmo u R-u - old" />
  
  <meta name="twitter:description" content="Udžbenik za vještinu ‘Osnove programskog jezika R’ na Fakultetu elektrotehnike i računarstva, Sveučilište u Zagrebu." />
  

<meta name="author" content="Damir Pintar">


<meta name="date" content="2017-08-23">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="deskriptivna.html">


<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />








<style type="text/css">
.showopt {
  background-color: #004c93;
  color: #FFFFFF; 
  width: 140px;
  height: 4	0px;
  text-align: center;
  vertical-align: middle !important;
  float: right;
  font-family: sans-serif;
  font-size:10 pt;
  border-radius: 8px;
}

.showopt:hover {
    background-color: #dfe4f2;
    color: #004c93;
}

pre.plot {
  background-color: white !important;
}
</style>

<script>
 $(document).ready(function() {

  $chunks = $('.fold');

  $chunks.each(function () {

    // add button to source code chunks
    if ( $(this).hasClass('s') ) {
      $('pre.r', this).prepend("<div class=\"showopt\">Prikaži rješenje</div><br style=\"line-height:22px;\"/>");
      $('pre.r', this).children('code').attr('class', 'folded');
    }

    // add button to output chunks
    if ( $(this).hasClass('o') ) {
      $('pre:not(.r)', this).has('code').prepend("<div class=\"showopt\">Prikaži ispis</div><br style=\"line-height:22px;\"/>");
      $('pre:not(.r)', this).children('code:not(r)').addClass('folded');

      // add button to plots
      $(this).find('img').wrap('<pre class=\"plot\"></pre>');
      $('pre.plot', this).prepend("<div class=\"showopt\">Prikaži sliku</div><br style=\"line-height:22px;\"/>");
      $('pre.plot', this).children('img').addClass('folded');

    }
  });

  // hide all chunks when document is loaded
  $('.folded').css('display', 'none')

  // function to toggle the visibility
  $('.showopt').click(function() {
    var label = $(this).html();
    if (label.indexOf("Prikaži") >= 0) {
      $(this).html(label.replace("Prikaži", "Sakrij"));
    } else {
      $(this).html(label.replace("Sakrij", "Prikaži"));
    }
    $(this).siblings('code, img').slideToggle('fast', 'swing');
  });
});
</script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>(Udžbenik za vještinu “Osnove programskog jezika R”)</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#predgovor"><i class="fa fa-check"></i>Predgovor</a></li>
</ul></li>
<li class="part"><span><b>I Osnovni elementi jezika R</b></span></li>
<li class="chapter" data-level="1" data-path="uvod.html"><a href="uvod.html"><i class="fa fa-check"></i><b>1</b> Uvod</a><ul>
<li class="chapter" data-level="1.1" data-path="uvod.html"><a href="uvod.html#sto-je-programski-jezik-r"><i class="fa fa-check"></i><b>1.1</b> Što je programski jezik R?</a><ul>
<li class="chapter" data-level="1.1.1" data-path="uvod.html"><a href="uvod.html#opcenito-o-r-u"><i class="fa fa-check"></i><b>1.1.1</b> Općenito o R-u</a></li>
<li class="chapter" data-level="1.1.2" data-path="uvod.html"><a href="uvod.html#alternative-jeziku-r"><i class="fa fa-check"></i><b>1.1.2</b> Alternative jeziku R</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="uvod.html"><a href="uvod.html#instalacija-programske-podrske"><i class="fa fa-check"></i><b>1.2</b> Instalacija programske podrške</a></li>
<li class="chapter" data-level="1.3" data-path="uvod.html"><a href="uvod.html#pregled-razvojnog-sucelja-rstudio"><i class="fa fa-check"></i><b>1.3</b> Pregled razvojnog sučelja <em>RStudio</em></a><ul>
<li class="chapter" data-level="1.3.1" data-path="uvod.html"><a href="uvod.html#interaktivna-konzola"><i class="fa fa-check"></i><b>1.3.1</b> Interaktivna konzola</a></li>
<li class="chapter" data-level="1.3.2" data-path="uvod.html"><a href="uvod.html#pisanje-r-skripti"><i class="fa fa-check"></i><b>1.3.2</b> Pisanje R skripti</a></li>
<li class="chapter" data-level="1.3.3" data-path="uvod.html"><a href="uvod.html#r-markdown"><i class="fa fa-check"></i><b>1.3.3</b> <em>R Markdown</em></a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="uvod.html"><a href="uvod.html#kako-koristiti-ovaj-udzbenik"><i class="fa fa-check"></i><b>1.4</b> Kako koristiti ovaj udžbenik?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="tipovi.html"><a href="tipovi.html"><i class="fa fa-check"></i><b>2</b> Osnovni tipovi podataka i operatori</a><ul>
<li class="chapter" data-level="2.1" data-path="tipovi.html"><a href="tipovi.html#osnovni-tipovi-podataka"><i class="fa fa-check"></i><b>2.1</b> Osnovni tipovi podataka</a></li>
<li class="chapter" data-level="2.2" data-path="tipovi.html"><a href="tipovi.html#operatori"><i class="fa fa-check"></i><b>2.2</b> Operatori</a></li>
<li class="chapter" data-level="2.3" data-path="tipovi.html"><a href="tipovi.html#nedostajuce-nepoznate-i-nemoguce-vrijednosti"><i class="fa fa-check"></i><b>2.3</b> Nedostajuće, nepoznate i nemoguće vrijednosti</a></li>
<li class="chapter" data-level="" data-path="tipovi.html"><a href="tipovi.html#zadaci-za-vjezbu"><i class="fa fa-check"></i>Zadaci za vježbu</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="vektori.html"><a href="vektori.html"><i class="fa fa-check"></i><b>3</b> Vektori, matrice i liste</a><ul>
<li class="chapter" data-level="3.1" data-path="vektori.html"><a href="vektori.html#vektori"><i class="fa fa-check"></i><b>3.1</b> Vektori</a><ul>
<li class="chapter" data-level="3.1.1" data-path="vektori.html"><a href="vektori.html#stvaranje-vektora"><i class="fa fa-check"></i><b>3.1.1</b> Stvaranje vektora</a></li>
<li class="chapter" data-level="3.1.2" data-path="vektori.html"><a href="vektori.html#operator"><i class="fa fa-check"></i><b>3.1.2</b> Operator <code>[</code></a></li>
<li class="chapter" data-level="3.1.3" data-path="vektori.html"><a href="vektori.html#principi-vektorizacije-i-recikliranja"><i class="fa fa-check"></i><b>3.1.3</b> Principi vektorizacije i recikliranja</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="vektori.html"><a href="vektori.html#indeksni-vektori"><i class="fa fa-check"></i><b>3.2</b> Indeksni vektori</a><ul>
<li class="chapter" data-level="3.2.1" data-path="vektori.html"><a href="vektori.html#lokacijsko-indeksiranje"><i class="fa fa-check"></i><b>3.2.1</b> Lokacijsko indeksiranje</a></li>
<li class="chapter" data-level="3.2.2" data-path="vektori.html"><a href="vektori.html#uvjetno-indeksiranje"><i class="fa fa-check"></i><b>3.2.2</b> Uvjetno indeksiranje</a></li>
<li class="chapter" data-level="3.2.3" data-path="vektori.html"><a href="vektori.html#imensko-indeksiranje"><i class="fa fa-check"></i><b>3.2.3</b> Imensko indeksiranje</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="vektori.html"><a href="vektori.html#matrice-i-polja"><i class="fa fa-check"></i><b>3.3</b> Matrice i polja</a><ul>
<li class="chapter" data-level="3.3.1" data-path="vektori.html"><a href="vektori.html#rezanje-matrica"><i class="fa fa-check"></i><b>3.3.1</b> Rezanje matrica</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="vektori.html"><a href="vektori.html#liste"><i class="fa fa-check"></i><b>3.4</b> Liste</a></li>
<li class="chapter" data-level="" data-path="vektori.html"><a href="vektori.html#zadaci-za-vjezbu-1"><i class="fa fa-check"></i>Zadaci za vježbu</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="okviri.html"><a href="okviri.html"><i class="fa fa-check"></i><b>4</b> Podatkovni okviri i faktori</a><ul>
<li class="chapter" data-level="4.1" data-path="okviri.html"><a href="okviri.html#podatkovni-okviri"><i class="fa fa-check"></i><b>4.1</b> Podatkovni okviri</a></li>
<li class="chapter" data-level="4.2" data-path="okviri.html"><a href="okviri.html#odabir-redaka-i-stupaca-podatkovnih-okvira"><i class="fa fa-check"></i><b>4.2</b> Odabir redaka i stupaca podatkovnih okvira</a></li>
<li class="chapter" data-level="4.3" data-path="okviri.html"><a href="okviri.html#dodavanje-i-brisanje-redaka-i-stupaca"><i class="fa fa-check"></i><b>4.3</b> Dodavanje i brisanje redaka i stupaca</a></li>
<li class="chapter" data-level="4.4" data-path="okviri.html"><a href="okviri.html#faktori"><i class="fa fa-check"></i><b>4.4</b> Faktori</a></li>
<li class="chapter" data-level="" data-path="okviri.html"><a href="okviri.html#zadaci-za-vjezbu-2"><i class="fa fa-check"></i>Zadaci za vježbu</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="kontrola.html"><a href="kontrola.html"><i class="fa fa-check"></i><b>5</b> Kontrola toka i objekti</a><ul>
<li class="chapter" data-level="5.1" data-path="kontrola.html"><a href="kontrola.html#naredbe-kontrole-toka"><i class="fa fa-check"></i><b>5.1</b> Naredbe kontrole toka</a><ul>
<li class="chapter" data-level="5.1.1" data-path="kontrola.html"><a href="kontrola.html#uvjetno-izvoenje-naredbi"><i class="fa fa-check"></i><b>5.1.1</b> Uvjetno izvođenje naredbi</a></li>
<li class="chapter" data-level="5.1.2" data-path="kontrola.html"><a href="kontrola.html#programske-petlje"><i class="fa fa-check"></i><b>5.1.2</b> Programske petlje</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="kontrola.html"><a href="kontrola.html#objekti-u-r-u"><i class="fa fa-check"></i><b>5.2</b> Objekti u R-u</a><ul>
<li class="chapter" data-level="5.2.1" data-path="kontrola.html"><a href="kontrola.html#s3-objekti"><i class="fa fa-check"></i><b>5.2.1</b> S3 objekti</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="kontrola.html"><a href="kontrola.html#zadaci-za-vjezbu-3"><i class="fa fa-check"></i>Zadaci za vježbu</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="paketi.html"><a href="paketi.html"><i class="fa fa-check"></i><b>6</b> Paketi, ugrađene funkcije i okoline</a><ul>
<li class="chapter" data-level="6.1" data-path="paketi.html"><a href="paketi.html#rad-s-paketima"><i class="fa fa-check"></i><b>6.1</b> Rad s paketima</a></li>
<li class="chapter" data-level="6.2" data-path="paketi.html"><a href="paketi.html#ugraene-funkcije"><i class="fa fa-check"></i><b>6.2</b> Ugrađene funkcije</a></li>
<li class="chapter" data-level="6.3" data-path="paketi.html"><a href="paketi.html#okoline"><i class="fa fa-check"></i><b>6.3</b> Okoline</a></li>
<li class="chapter" data-level="" data-path="paketi.html"><a href="paketi.html#zadaci-za-vjezbu-4"><i class="fa fa-check"></i>Zadaci za vježbu</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="korisnik.html"><a href="korisnik.html"><i class="fa fa-check"></i><b>7</b> Korisnički definirane funkcije</a><ul>
<li class="chapter" data-level="7.1" data-path="korisnik.html"><a href="korisnik.html#kako-definirati-funkciju"><i class="fa fa-check"></i><b>7.1</b> Kako definirati funkciju</a><ul>
<li class="chapter" data-level="7.1.1" data-path="korisnik.html"><a href="korisnik.html#princip-kopiranja-kod-izmjene-copy-on-modify"><i class="fa fa-check"></i><b>7.1.1</b> Princip “kopiranja kod izmjene” (copy-on-modify)</a></li>
<li class="chapter" data-level="7.1.2" data-path="korisnik.html"><a href="korisnik.html#funkcija-kao-objekt"><i class="fa fa-check"></i><b>7.1.2</b> Funkcija kao objekt</a></li>
<li class="chapter" data-level="7.1.3" data-path="korisnik.html"><a href="korisnik.html#genericke-funkcije"><i class="fa fa-check"></i><b>7.1.3</b> Generičke funkcije</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="korisnik.html"><a href="korisnik.html#zadaci-za-vjezbu-5"><i class="fa fa-check"></i>Zadaci za vježbu</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="porodica-funkcija-apply.html"><a href="porodica-funkcija-apply.html"><i class="fa fa-check"></i><b>8</b> Porodica funkcija <code id="apply">apply</code></a><ul>
<li class="chapter" data-level="8.1" data-path="porodica-funkcija-apply.html"><a href="porodica-funkcija-apply.html#sto-su-apply-funkcije"><i class="fa fa-check"></i><b>8.1</b> Što su <code>apply</code> funkcije?</a></li>
<li class="chapter" data-level="8.2" data-path="porodica-funkcija-apply.html"><a href="porodica-funkcija-apply.html#funkcija-apply"><i class="fa fa-check"></i><b>8.2</b> Funkcija <code>apply</code></a></li>
<li class="chapter" data-level="8.3" data-path="porodica-funkcija-apply.html"><a href="porodica-funkcija-apply.html#funkcije-lapply-sapply-i-vapply"><i class="fa fa-check"></i><b>8.3</b> Funkcije <code>lapply</code>, <code>sapply</code> i <code>vapply</code></a></li>
<li class="chapter" data-level="8.4" data-path="porodica-funkcija-apply.html"><a href="porodica-funkcija-apply.html#ostale-funkcije-iz-porodice-apply-i-dostupne-alternative"><i class="fa fa-check"></i><b>8.4</b> Ostale funkcije iz porodice <code>apply</code> i dostupne alternative</a></li>
<li class="chapter" data-level="" data-path="porodica-funkcija-apply.html"><a href="porodica-funkcija-apply.html#zadaci-za-vjezbu-6"><i class="fa fa-check"></i>Zadaci za vježbu</a></li>
</ul></li>
<li class="part"><span><b>II Upravljanje podacima i vizualizacije</b></span></li>
<li class="chapter" data-level="9" data-path="cijev.html"><a href="cijev.html"><i class="fa fa-check"></i><b>9</b> Operator cjevovoda i uredni podaci</a><ul>
<li class="chapter" data-level="9.1" data-path="cijev.html"><a href="cijev.html#operator-cjevovoda"><i class="fa fa-check"></i><b>9.1</b> Operator cjevovoda</a></li>
<li class="chapter" data-level="9.2" data-path="cijev.html"><a href="cijev.html#uredni-podaci"><i class="fa fa-check"></i><b>9.2</b> Uredni podaci</a><ul>
<li class="chapter" data-level="9.2.1" data-path="cijev.html"><a href="cijev.html#funkcije-gather-i-spread"><i class="fa fa-check"></i><b>9.2.1</b> Funkcije <code>gather</code> i <code>spread</code></a></li>
<li class="chapter" data-level="9.2.2" data-path="cijev.html"><a href="cijev.html#funkcije-separate-i-unite"><i class="fa fa-check"></i><b>9.2.2</b> Funkcije <code>separate</code> i <code>unite</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cijev.html"><a href="cijev.html#zadaci-za-vjezbu-7"><i class="fa fa-check"></i>Zadaci za vježbu</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="datumi.html"><a href="datumi.html"><i class="fa fa-check"></i><b>10</b> Rad sa datumima i znakovnim nizovima</a><ul>
<li class="chapter" data-level="10.1" data-path="datumi.html"><a href="datumi.html#rad-sa-datumima"><i class="fa fa-check"></i><b>10.1</b> Rad sa datumima</a><ul>
<li class="chapter" data-level="10.1.1" data-path="datumi.html"><a href="datumi.html#klasa-date"><i class="fa fa-check"></i><b>10.1.1</b> Klasa <code>Date</code></a></li>
<li class="chapter" data-level="10.1.2" data-path="datumi.html"><a href="datumi.html#klase-posixct-i-posixlt"><i class="fa fa-check"></i><b>10.1.2</b> Klase <code>POSIXct</code> i <code>POSIXlt</code></a></li>
<li class="chapter" data-level="10.1.3" data-path="datumi.html"><a href="datumi.html#paket-lubridate"><i class="fa fa-check"></i><b>10.1.3</b> Paket <code>lubridate</code></a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="datumi.html"><a href="datumi.html#rad-sa-znakovnim-nizovima"><i class="fa fa-check"></i><b>10.2</b> Rad sa znakovnim nizovima</a><ul>
<li class="chapter" data-level="10.2.1" data-path="datumi.html"><a href="datumi.html#analiza-teksta-i-regularni-izrazi"><i class="fa fa-check"></i><b>10.2.1</b> Analiza teksta i regularni izrazi</a></li>
<li class="chapter" data-level="10.2.2" data-path="datumi.html"><a href="datumi.html#paket-stringr"><i class="fa fa-check"></i><b>10.2.2</b> Paket <code>stringr</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="datumi.html"><a href="datumi.html#zadaci-za-vjezbu-8"><i class="fa fa-check"></i>Zadaci za vježbu</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html"><i class="fa fa-check"></i><b>11</b> Prilagodba podatkovnih skupova uz paket <code>dplyr</code></a><ul>
<li class="chapter" data-level="11.1" data-path="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#ogledni-podatkovni-skup-titanic"><i class="fa fa-check"></i><b>11.1</b> Ogledni podatkovni skup: <em>Titanic</em></a></li>
<li class="chapter" data-level="11.2" data-path="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#stvaranje-podskupa-obzervacija-uz-filter-i-slice"><i class="fa fa-check"></i><b>11.2</b> Stvaranje podskupa obzervacija uz <code>filter</code> i <code>slice</code></a></li>
<li class="chapter" data-level="11.3" data-path="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#stvaranje-podskupa-varijabli-uz-select"><i class="fa fa-check"></i><b>11.3</b> Stvaranje podskupa varijabli uz <code>select</code></a></li>
<li class="chapter" data-level="11.4" data-path="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#stvaranje-novih-stupaca-uz-mutate"><i class="fa fa-check"></i><b>11.4</b> Stvaranje novih stupaca uz <code>mutate</code></a></li>
<li class="chapter" data-level="11.5" data-path="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#ogledni-podatkovni-skup-houston-flights"><i class="fa fa-check"></i><b>11.5</b> Ogledni podatkovni skup: <em>Houston flights</em></a></li>
<li class="chapter" data-level="11.6" data-path="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#grupiranje-i-agregacija-uz-group_by-i-summarise"><i class="fa fa-check"></i><b>11.6</b> Grupiranje i agregacija uz <code>group_by</code> i <code>summarise</code></a></li>
<li class="chapter" data-level="11.7" data-path="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#spajanje-podatkovnih-okvira-uz-join-funkcije"><i class="fa fa-check"></i><b>11.7</b> Spajanje podatkovnih okvira uz join funkcije</a></li>
<li class="chapter" data-level="11.8" data-path="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#integracija-sa-relacijskim-bazama-podataka"><i class="fa fa-check"></i><b>11.8</b> Integracija sa relacijskim bazama podataka</a></li>
<li class="chapter" data-level="" data-path="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#zadaci-za-vjezbu-9"><i class="fa fa-check"></i>Zadaci za vježbu</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="vizualizacija-podataka-uz-paket-ggplot2.html"><a href="vizualizacija-podataka-uz-paket-ggplot2.html"><i class="fa fa-check"></i><b>12</b> Vizualizacija podataka uz paket <code id="ggplot2">ggplot2</code></a><ul>
<li class="chapter" data-level="12.1" data-path="vizualizacija-podataka-uz-paket-ggplot2.html"><a href="vizualizacija-podataka-uz-paket-ggplot2.html#eksploratorna-analiza-podataka"><i class="fa fa-check"></i><b>12.1</b> Eksploratorna analiza podataka</a></li>
<li class="chapter" data-level="12.2" data-path="vizualizacija-podataka-uz-paket-ggplot2.html"><a href="vizualizacija-podataka-uz-paket-ggplot2.html#vizualizacija-podataka-uz-pomoc-jezika-r"><i class="fa fa-check"></i><b>12.2</b> Vizualizacija podataka uz pomoć jezika R</a></li>
<li class="chapter" data-level="12.3" data-path="vizualizacija-podataka-uz-paket-ggplot2.html"><a href="vizualizacija-podataka-uz-paket-ggplot2.html#graficka-gramatika-i-paket-ggplot2"><i class="fa fa-check"></i><b>12.3</b> Grafička gramatika i paket <code>ggplot2</code></a><ul>
<li class="chapter" data-level="12.3.1" data-path="vizualizacija-podataka-uz-paket-ggplot2.html"><a href="vizualizacija-podataka-uz-paket-ggplot2.html#aspekti-podataka-estetike-i-geometrije"><i class="fa fa-check"></i><b>12.3.1</b> Aspekti podataka, estetike i geometrije</a></li>
<li class="chapter" data-level="12.3.2" data-path="vizualizacija-podataka-uz-paket-ggplot2.html"><a href="vizualizacija-podataka-uz-paket-ggplot2.html#fiksni-parametri-geometrije"><i class="fa fa-check"></i><b>12.3.2</b> Fiksni parametri geometrije</a></li>
<li class="chapter" data-level="12.3.3" data-path="vizualizacija-podataka-uz-paket-ggplot2.html"><a href="vizualizacija-podataka-uz-paket-ggplot2.html#aspekti-statistike-i-pozicije"><i class="fa fa-check"></i><b>12.3.3</b> Aspekti statistike i pozicije</a></li>
<li class="chapter" data-level="12.3.4" data-path="vizualizacija-podataka-uz-paket-ggplot2.html"><a href="vizualizacija-podataka-uz-paket-ggplot2.html#povezanost-geometrije-i-statistike"><i class="fa fa-check"></i><b>12.3.4</b> Povezanost geometrije i statistike</a></li>
<li class="chapter" data-level="12.3.5" data-path="vizualizacija-podataka-uz-paket-ggplot2.html"><a href="vizualizacija-podataka-uz-paket-ggplot2.html#aspekti-skale-koordinatnog-sustava-i-teme"><i class="fa fa-check"></i><b>12.3.5</b> Aspekti skale, koordinatnog sustava i teme</a></li>
<li class="chapter" data-level="12.3.6" data-path="vizualizacija-podataka-uz-paket-ggplot2.html"><a href="vizualizacija-podataka-uz-paket-ggplot2.html#uvjetni-facetirani-grafovi"><i class="fa fa-check"></i><b>12.3.6</b> Uvjetni (facetirani) grafovi</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="vizualizacija-podataka-uz-paket-ggplot2.html"><a href="vizualizacija-podataka-uz-paket-ggplot2.html#grafovi-u-eksploratornoj-analizi-i-izvjestavanju"><i class="fa fa-check"></i><b>12.4</b> Grafovi u eksploratornoj analizi i izvještavanju</a></li>
<li class="chapter" data-level="" data-path="vizualizacija-podataka-uz-paket-ggplot2.html"><a href="vizualizacija-podataka-uz-paket-ggplot2.html#zadaci-za-vjezbu-10"><i class="fa fa-check"></i>Zadaci za vježbu</a></li>
</ul></li>
<li class="part"><span><b>III Statistika i strojno učenje u jeziku R</b></span></li>
<li class="chapter" data-level="13" data-path="razdiobe.html"><a href="razdiobe.html"><i class="fa fa-check"></i><b>13</b> Statističko programiranje, razdiobe i simulacije</a><ul>
<li class="chapter" data-level="13.1" data-path="razdiobe.html"><a href="razdiobe.html#rad-sa-razdiobama-vjerojatnosti-u-jeziku-r"><i class="fa fa-check"></i><b>13.1</b> Rad sa razdiobama vjerojatnosti u jeziku R</a></li>
<li class="chapter" data-level="13.2" data-path="razdiobe.html"><a href="razdiobe.html#simulacije"><i class="fa fa-check"></i><b>13.2</b> Simulacije</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="deskriptivna.html"><a href="deskriptivna.html"><i class="fa fa-check"></i><b>14</b> Deskriptivna i inferencijalna statistika u jeziku R</a><ul>
<li class="chapter" data-level="14.1" data-path="deskriptivna.html"><a href="deskriptivna.html#deskriptivna-statistika"><i class="fa fa-check"></i><b>14.1</b> Deskriptivna statistika</a><ul>
<li class="chapter" data-level="14.1.1" data-path="deskriptivna.html"><a href="deskriptivna.html#univarijantna-deskriptivna-statistika"><i class="fa fa-check"></i><b>14.1.1</b> Univarijantna deskriptivna statistika</a></li>
<li class="chapter" data-level="14.1.2" data-path="deskriptivna.html"><a href="deskriptivna.html#bivarijantna-i-multivarijantna-deskriptivna-statistika"><i class="fa fa-check"></i><b>14.1.2</b> Bivarijantna i multivarijantna deskriptivna statistika</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="deskriptivna.html"><a href="deskriptivna.html#inferencijalna-statistika"><i class="fa fa-check"></i><b>14.2</b> Inferencijalna statistika</a><ul>
<li class="chapter" data-level="14.2.1" data-path="deskriptivna.html"><a href="deskriptivna.html#testiranje-hipoteza"><i class="fa fa-check"></i><b>14.2.1</b> Testiranje hipoteza</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="regresija.html"><a href="regresija.html"><i class="fa fa-check"></i><b>15</b> Odabrane metode strojnog učenja: regresijska analiza</a><ul>
<li class="chapter" data-level="15.1" data-path="regresija.html"><a href="regresija.html#strojno-ucenje-i-prediktivna-analiza"><i class="fa fa-check"></i><b>15.1</b> Strojno učenje i prediktivna analiza</a><ul>
<li class="chapter" data-level="15.1.1" data-path="regresija.html"><a href="regresija.html#stvaranje-prediktivnog-modela"><i class="fa fa-check"></i><b>15.1.1</b> Stvaranje prediktivnog modela</a></li>
<li class="chapter" data-level="15.1.2" data-path="regresija.html"><a href="regresija.html#jednostavna-linearna-regresija"><i class="fa fa-check"></i><b>15.1.2</b> Jednostavna linearna regresija</a></li>
<li class="chapter" data-level="15.1.3" data-path="regresija.html"><a href="regresija.html#funkcija-lm"><i class="fa fa-check"></i><b>15.1.3</b> Funkcija <code>lm</code></a></li>
<li class="chapter" data-level="15.1.4" data-path="regresija.html"><a href="regresija.html#linearna-regresija-i-kategorijske-varijable"><i class="fa fa-check"></i><b>15.1.4</b> Linearna regresija i kategorijske varijable</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="regresija.html"><a href="regresija.html#visestruka-multipla-linearna-regresija"><i class="fa fa-check"></i><b>15.2</b> Višestruka (multipla) linearna regresija</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Programirajmo u R-u - old</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="regresija" class="section level1">
<h1><span class="header-section-number">15</span> Odabrane metode strojnog učenja: regresijska analiza</h1>
<hr />
<div id="strojno-ucenje-i-prediktivna-analiza" class="section level2">
<h2><span class="header-section-number">15.1</span> Strojno učenje i prediktivna analiza</h2>
<p><em>Strojno učenje</em> je polje računalne znanosti koje se bavi specifičnim načinom programiranja u kojem računalu ne dajemo eksplicitne instrukcije, već očekujemo da računalo samostalno dođe do određenih spoznaja na osnovu odabranih podatkovnih skupova i određene metode “učenja”. Strojno učenje se često dijeli na tzv. “nadzirano učenje” (engl. <em>supervised learning</em>), gdje imamo jasno definirane ulaze i izlaze tj. ciljeve, te “nenadzirano učenje”, gdje nemamo unaprijed definirane izlaze već očekujemo da će računalo analizirajući samo ulaze doći do nekih korisnih spoznaja o samim podacima.</p>
<p>Prediktivna analiza podataka jest vrsta statističke i dubinske analize podataka koja koristi metode nadziranog strojnog učenja kako bi na osnovu povijesnih podataka omogućila predviđanje određenih varijabli za buduće slučajeve. Na primjer, za internetske aukcije često nas zanima koju konačnu cijenu možemo očekivati za određeni predmet. Ako imamo podatke o sličnim aukcijama iz prošlosti, prediktivna analiza nam može pomoći da stvorimo tzv. “model” koji će iz karakteristika predmeta kojeg još nismo stavili na aukciju pokušati predvidjeti koliku konačnu cijenu možemo očekivati.</p>
<p>Ako koristimo pojednostavljenu podjelu tipova varijabli iz prethodne lekcije, onda možemo reći da ciljna vrijednost koju želimo “pogoditi” po tipu može biti:</p>
<ul>
<li>numerička ili</li>
<li>kategorijska</li>
</ul>
<p>Pogađanje numeričke varijable često se naziva <em>regresijskom analizom</em> dok se pogađanje kategorijske naziva <em>klasifikacijskom analizom</em>. Ovo nije previše čvrsta podjela, budući da se neke regresijske metode mogu koristiti za klasifikaciju i obrnuto.</p>
<hr />
<div id="stvaranje-prediktivnog-modela" class="section level3">
<h3><span class="header-section-number">15.1.1</span> Stvaranje prediktivnog modela</h3>
<p>Za stvaranje prediktivnog modela potrebne su nam dvije stvari:</p>
<ul>
<li>skup podataka za treniranje koji sadržava ulazne varijable (prediktore) i ciljnu varijablu</li>
<li>odabrana metoda nadziranog strojnog učenja (tj. njezina implementacija u odabranom programskom jeziku ili analitičkom alatu)</li>
</ul>
<p>Metoda strojnog učenja će na osnovu primljenog podatkovnog skupa i odabranih ulaznih parametara stvoriti prediktivni model - formulu ili algoritam koji iz ulaznih varijabli računa tj. procjenjuje izlaznu varijablu. Ovisno o odabranoj metodi, model može biti tzv. “bijela kutija”, tj. može nam pružiti informacije o tome kako računa izlaznu vrijednost iz čega se potencijalno mogu izvući korisne informacije o stvarima iz stvarnog svijeta koje analizirani podaci opisuju. Ponekad nam je ova <em>interpretabilnost modela</em> važnija od njegove <em>prediktivne snage</em>, tj. nije nam toliko bitna sama točnost predikcija koliko prikupljanje znanja o tome kako ulazne varijable utječu na izlaznu i u kojoj mjeri. S druge strane, modeli “crne kutije” nisu interpretabilni, ne daju nam lako iskoristivo znanje o tome kako od ulaznih varijabli računaju izlazne, ali mogu biti vrlo uspješni glede točnosti predikcija. Iz ovih razloga odabir modela često ovisi i o željama krajnjih korisnika koji nisu nužno sami analitičari koji upravljaju podacima i provode analizu.</p>
<hr />
<p>Kada stvorimo prediktivni model, moramo procijeniti koliko je on zapravo učinkovit u stvaranju predikcija. Tipičan način provjere modela uključuje usporedbu predikcija i stvarnih vrijednosti, tj. analizu “grešaka” (koje često zovemo “ostacima” ili <em>rezidualima</em>). Jedna od češćih načina računanja greške kod predikcije numeričkih vrijednosti je “srednja kvadratna greška reziduala” (engl. <em>RMSE - residual mean squared error</em>) gdje računamo koliko u prosjeku “promašujemo” ciljanu vrijednost, pri čemu kvadrat greške sprječava kompenziranje pozitivnih grešaka negativnim te jače penalizira veće greške.</p>
<p>Stvaranje modela često zovemo “treniranjem”, pa se tako i ulazni podatkovni skup zove “skup za treniranje”. Kod treniranja odabrana metoda strojnog učenja poznaje i ulaze i izlaze te na osnovu tih informacija stvara model. Ovdje postoji moguća zamka - prediktivni model inherentno u neku ruku “vara”, budući da su mu izlazi unaprijed poznati, pa se može opravdano postaviti pitanje da li je njegova učinkovitost na trening skupu zapravo dobra reprezentacija učinkovitosti modela općenito, tj. na novim, nepoznatim podacima.</p>
<p>Upravo iz tog razloga prije treniranja modela analitičar inicijalni podatkovni skup rastavlja na dva dijela:</p>
<ul>
<li>skup za treniranje (obično oko 70% podataka)</li>
<li>skup za testiranje (preostalih 30% podataka)</li>
</ul>
<p>Na ovaj način učinkovitost modela procjenjujemo na “nepoznatim” podacima te dobivamo objektivniju mjeru stvarne učinkovitosti. Gore navedena metoda nije jedina - moguće je rastaviti skup na više dijelova (npr. na tri dijela, gdje “srednji” dio može služiti za “popravljanje” modela prije konačnog testiranja) ili možemo provesti više rezanja cijelog skupa i onda “usrednjiti grešku” (kako bi spriječili da nam slučajni odabir neobičnog testnog skupa “zamaskira” učinkovitost modela).</p>
<p>Pogledajmo jedan od načina rastavljanja inicijalnog podatkovnog skupa na skupove za trening i testiranje.</p>
<hr />
<p><strong>Zadatak 15.1 - razdvajanje podatkovnog skupa na trening i test skup</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># umjetni podatkovni okvir koji predstavlja ulazne podatke</span>
df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">id =</span> <span class="dv">1</span>:<span class="dv">100</span>, <span class="dt">a =</span> <span class="dv">100</span>*<span class="kw">runif</span>(<span class="dv">100</span>) %&gt;%<span class="st"> </span><span class="kw">round</span>(<span class="dv">4</span>), 
                 <span class="dt">b =</span> <span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;C&quot;</span>,<span class="st">&quot;D&quot;</span>), <span class="dv">100</span>, T, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)),
                 <span class="dt">c =</span> <span class="dv">1</span>:<span class="dv">100</span> +<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dv">5</span>, <span class="dv">2</span>) %&gt;%<span class="st"> </span><span class="kw">round</span>(<span class="dv">2</span>))

<span class="co"># podijelite okvir na skup za treniranje i skup za testiranje</span>
<span class="co"># okvire nazovite </span>
<span class="co">#   `trening` -  sadrži 70% redaka okvira `df` </span>
<span class="co">#   `test` - sadrži sve preostale retke</span>
<span class="co">#</span>
<span class="co"># savjet: možete napraviti pomoćni vektor `indeksi_trening` koji će sadržavati</span>
<span class="co">#         nasumično odabranih 70% indekasa redaka okvira `df`</span></code></pre></div>
<div class="fold s o">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">indeksi_trening &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span>:<span class="kw">nrow</span>(df), <span class="kw">round</span>(<span class="fl">0.7</span> *<span class="st"> </span><span class="kw">nrow</span>(df)))
trening &lt;-<span class="st"> </span>df[indeksi_trening, ]
test &lt;-<span class="st"> </span>df[-indeksi_trening, ]

<span class="kw">nrow</span>(trening)
<span class="kw">nrow</span>(test)
<span class="kw">head</span>(trening)</code></pre></div>
<pre><code>## [1] 70
## [1] 30
##    id     a b     c
## 28 28 84.54 D 34.09
## 56 56 69.26 C 61.97
## 59 59 39.37 D 66.82
## 44 44 62.57 D 51.50
## 40 40  5.03 D 44.59
## 32 32 15.20 C 36.25</code></pre>
</div>
<p>U nastavku lekcije ćemo zbog preglednosti i jednostavnosti uglavnom zanemariti ovaj pristup te koristiti cijeli podatkovni skup za treniranje i prikaz rezultata, no usprkos tome moramo imati u vidu da za objektivnu konačnu evaluaciju prediktivnih modela u praksi uvijek moramo koristiti “novi”, nepoznati skup podataka.</p>
<hr />
<p>U ovoj lekciji obradit ćemo metodu <strong>linearne regresije</strong>. Ovo je iznimno popularna metoda prediktivne analize koja se usprkos svojoj relativnoj jednostavnosti često pokaže kao vrlo učinkovita. Uz to, razumijevanje linearne regresije postavlja čvrste temelje za učenje i razumijevanje naprednijih metoda. Zbog svega toga, linearna regresija predstavlja logičan i vrlo važan prvi korak za ulazak u svijet prediktivne analize.</p>
<hr />
</div>
<div id="jednostavna-linearna-regresija" class="section level3">
<h3><span class="header-section-number">15.1.2</span> Jednostavna linearna regresija</h3>
<p>Jednostavna linearna regresija je metoda nadziranog strojnog učenja za predviđanje ciljne numeričke varijable uz pomoć linearne funkcije ulazne varijable. Na ovaj način stvaranje prediktivnog modela svodi se na postupak određivanja koeficijenta smjera i odsječka koji će tvoriti jednostavnu formulu za izračun ciljne varijable uz pomoć ulaznog parametra. Budući da se ova metoda svodi na pogađanje navedenih parametara, metoda linearne regresije spada u tzv. “parametarske metode” strojnog učenja, tj. prediktivne analize.</p>
<p>Motivaciju za provođenje jednostavne linearne regresije često nalazimo tijekom procesa eksploratorne analize podataka, poglavito tijekom vizualizacije dvije numeričke varijable točkastim grafovima. Ukoliko je jedna od tih varijabli nama interesantna kao ciljna varijabla prediktivnog modela, a na grafu povijesnih podataka vidimo kako u međuodnosu s nekom drugom varijablu točke tvore približni oblik pravca, onda se tu radi o očitom kandidatu za metodu jednostavne linearne regresije.</p>
<hr />
<p>Pogledajmo sljedeći zadatak. U njemu se koristi “umjetni” podatkovni okvir u kojem imamo ulaznu varijablu <code>x</code> i četiri moguće ciljne varijable <code>y1</code>, <code>y2</code>, <code>y3</code> i <code>y4</code>. Svaka od tih varijabli nastala je određenom transformacijom ulaza uz dodavanje određene količine šuma. Ideja zadatka jest proučiti odnos između ulazne i mogućih izlaznih varijabli te uočiti koji od tih odnosa je dobar kandidat za jednostavnu linearnu regresiju.</p>
<hr />
<p><strong>Zadatak 15.2 - uočavanje linearne povezanosti varijabli</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># u varijablu `df` učitajte podatke iz datoteke `podaci1.csv`</span>
<span class="co"># proučite učitani podatkovni okvir</span>


<span class="co"># nacrtajte točkaste grafove odnosa varijable </span>
<span class="co"># x sa svakom pojedinom varijablom y iz gornjeg podatkovnog okvira</span>
<span class="co"># svakom grafu dodajte i geometriju zaglađivanja, metoda `lm`</span>

<span class="co"># odgovorite na pitanja:</span>
<span class="co"># na kojim grafovima uočavate moguću linearnu povezanost varijabli?</span>
<span class="co"># koji graf predočava nelinearnu povezanost?</span>
<span class="co"># za koji graf biste mogli reći da su varijable nezavisne?</span></code></pre></div>
<div class="fold s o">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;podaci1.csv&quot;</span>, <span class="dt">stringsAsFactors =</span> F, <span class="dt">encoding =</span> <span class="st">&quot;UTF-8&quot;</span>)
g1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(x, y1)) +<span class="st"> </span><span class="kw">geom_point</span>() +<span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&#39;lm&#39;</span>) 
g2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(x, y2)) +<span class="st"> </span><span class="kw">geom_point</span>() +<span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&#39;lm&#39;</span>) 
g3 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(x, y3)) +<span class="st"> </span><span class="kw">geom_point</span>() +<span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&#39;lm&#39;</span>) 
g4 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(x, y4)) +<span class="st"> </span><span class="kw">geom_point</span>() +<span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&#39;lm&#39;</span>) 


<span class="kw">grid.arrange</span>(g1, g2, g3, g4)</code></pre></div>
<p><img src="osnoveR_files/figure-html/unnamed-chunk-517-1.png" width="672" /></p>
</div>
<hr />
<p>Vizualizacija odnosa dvaju varijabli nam obično daje relativno dobru intuiciju kada možemo očekivati dobro funkcioniranje linearnog modela. U prethodnoj lekciji smo naučili da postoji i numerička vrijednost za opis snage linearnog odnosa dvaju varijabli - tzv. “Pearson-ov koeficijent korelacije” kojeg možemo dobiti uz pomoć funkcije <code>cor</code>.</p>
<p>Izračunajmo koeficijent korelacije za parove ulazne i izlaznih varijabli prikazane na grafovima iz prethodnog zadatka.</p>
<hr />
<p><strong>Zadatak 15.3 - izračun koeficijenta korelacije</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># za svaki graf iz prethodnog zadatka izračunajte i ispišite</span>
<span class="co"># koeficijent korelacije između prikazanih varijabl (funkcija `cor`)</span></code></pre></div>
<div class="fold s o">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>(df$x, df$y1)
<span class="kw">cor</span>(df$x, df$y2)
<span class="kw">cor</span>(df$x, df$y3)
<span class="kw">cor</span>(df$x, df$y4)</code></pre></div>
<pre><code>## [1] 0.9758326
## [1] 0.6765991
## [1] -0.04977038
## [1] 0.1783745</code></pre>
</div>
<hr />
<p>Pored ove mjere za opisivanje snage linearnog odnosa često koristimo i varijablu nazvanu “koeficijent determinacije” ili - poznatije - “R kvadrat” (engl. <em>R squared</em>). Naziv ove varijable potječe od činjenice da se koeficijent korelacije kod jednostavnog linearnog modela (kojeg smo računali u prethodnom zadatku) često naziva <code>R</code>, a veličina <code>R kvadrat</code> je kod jednostavnog linearnog modela točno jednaka njezinom kvadratu. Ova veličina može poprimiti vrijednosti od 0 do 1, gdje vrijednost bliska 1 označava gotovo savršenu linearnu vezu dok vrijednost bliska 0 njezine nepostojanje.</p>
<p>Interpretacija mjere “R kvadrat” je dosta bitna te ju nije naodmet naučiti - ona se definira kao “količina varijabilnosti koja je objašnjena modelom”. Ovo možemo jednostavno objasniti na sljedeći način - gledamo omjer koliko su točke na grafu “raspršene” oko zamišljenog pravca s obzirom na njihovu “općenitu raspršenost” oko horizontalnog pravca koji bi prolazio njihovom aritmetičkom sredinom.</p>
<p>Važno je napomenuti da je “R kvadrat” jedna od važnijih kriterija za ocjenu kvalitete linearnog modela te je kao takva često sadržana u opisu rezultata modela. Usprkos tome, nema jasne granice što predstavlja “dobar” iznos ove mjere - čak i model sa malim iznosom “R kvadrata” se može pokazati korisnim, ovisno o ostalim kriterijima i konkretnom scenariju primjene.</p>
<p>Prikažimo sada kako stvaramo linearne modele u jeziku R.</p>
<hr />
</div>
<div id="funkcija-lm" class="section level3">
<h3><span class="header-section-number">15.1.3</span> Funkcija <code>lm</code></h3>
<p>U jeziku R jednostavne linearne modele stvaramo uz pomoć funkcije <code>lm</code>, što je skraćeno od <em>linear model</em>. Ova funkcija ima niz parametara, a mi ćemo koristiti najvažnije - statističku formulu i podatkovni skup na kojem treniramo:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lm</span>(formula, data)</code></pre></div>
<p>Pojam formule već smo objasnili u poglavlju o vizualizaciji, budući da su istu kao parametar koristili uvjetni (facetirani) grafovi. Podsjetimo se o čemu se radi - “formula” je zapravo skraćeni zapis notacije gdje želimo reći da lijeva strana formule “ovisi” o desnoj strani formule. Ako želimo trenirati linearnu regresiju ciljne varijable <code>y</code> u ovisnosti o varijabli <code>x</code> za podatkovni okvir <code>df</code> i konačni model spremiti u varijablu <code>linMod</code>, onda to u programskom kodu izgleda ovako:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">linMod &lt;-<span class="st"> </span><span class="kw">lm</span>(y ~<span class="st"> </span>x, <span class="dt">data =</span> df)</code></pre></div>
<p>Pokušajmo ovo izvesti samostalno u sljedećem zadatku.</p>
<hr />
<p><strong>Zadatak 15.4 - stvaranje jednostavnog linearnog modela</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># uz pomoć funkcije `lm` stvorite linearni model podataka iz tablice `df`</span>
<span class="co"># gdje je `x` ulazna a `y1` izlazna varijabla</span>
<span class="co"># rezultat spremite u varijablu `linMod`</span>


<span class="co"># ispišite varijablu `linMod`</span></code></pre></div>
<div class="fold s o">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># uz pomoć funkcije `lm` stvorite linearni model podataka iz tablice `df`</span>
<span class="co"># gdje je `x` ulazna a `y1` izlazna varijabla</span>
<span class="co"># rezultat spremite u varijablu `linMod`</span>
linMod &lt;-<span class="st"> </span><span class="kw">lm</span>(y1 ~<span class="st"> </span>x, <span class="dt">data =</span> df)

<span class="co"># ispišite varijablu `linMod`</span>
linMod</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y1 ~ x, data = df)
## 
## Coefficients:
## (Intercept)            x  
##      46.733        3.999</code></pre>
</div>
<hr />
<p>Ispis varijable <code>linMod</code> nam ispisuje formulu koja je korištena za stvaranje modela te izračunate parametre - koeficijent smjera i odsječak (koji nam u pravilu nije interesantan). Koeficijent interpretiramo na sljedeći način - <em>za pomak od jedne jedinice ulazne varijable, izlazna se mijenja za iznos koeficijenta</em>.</p>
<p>Varijabla <code>linMod</code> iz prethodnog primjera je objekt klase <code>lm</code>. Ovo je relativno složen objekt, iako je to teško naslutiti samim ispisivanjem modela, pri čemu dobivamo samo izračunate koeficijent. Ovaj objekt zapravo sadržava ne samo koeficijente, već i bogati skup informacija vezanih uz stvoreni linearni model, što uključuje čak i sam podatkovni skup pomoću kojeg je model stvoren.</p>
<hr />
<p>Nad ovim objektom možemo izvesti sljedeće funkcije:</p>
<ul>
<li><code>coef</code> - vraća koeficijente u obliku vektora</li>
<li><code>fitted.values</code> - vraća vektor predikcija dobiven primjenom modela na skup za treniranje</li>
<li><code>residuals</code> - vraća vektor grešaka dobiven primjenom modela na skup za treniranje</li>
<li><code>summary</code> - daje sažetak najvažnijih informacija o modelu</li>
</ul>
<p>Isprobajmo funkciju sažetka - <code>summary</code> - nad našim linearnim modelom.</p>
<hr />
<p><strong>Zadatak 15.5 - sažetak linearnog modela</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># izvršite funkciju `summary` nad linearnim modelom `linMod`</span></code></pre></div>
<div class="fold s o">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(linMod)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y1 ~ x, data = df)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -74.010 -15.492  -1.021  15.613  77.371 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 46.73328    5.26089   8.883  3.2e-14 ***
## x            3.99851    0.09045  44.208  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 26.35 on 98 degrees of freedom
## Multiple R-squared:  0.9522, Adjusted R-squared:  0.9518 
## F-statistic:  1954 on 1 and 98 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<hr />
<p>Vidimo da smo dobili niz informacija vezanih uz naš prediktivni model. U nastavku ćemo pokušati jednostavnim jezikom, bez previše oslanjanja na znanje statistike, objasniti što nam govori veći dio dobivenih informacija.</p>
<p>Za početak uočimo da kod stvaranja linearnog modela iz nekih podataka imamo nekoliko različitih “nesigurnosti” u rezultat:</p>
<ol style="list-style-type: decimal">
<li>Da li linearna međuzavisnost uopće postoji, ili se uočena kolinearnost mogla pojaviti slučajno?</li>
<li>Ako koeficijent postoji, koliko smo sigurni da je izračunati koeficijent upravo taj?</li>
<li>Ako međuzavisnost postoji a mi smo uspjeli pogoditi “pravi” koeficijent, koliko nam “neobjašnjiva varijabilnost” utječe na točnost predikcija?</li>
</ol>
<p>Prikazani sažetak nam pruža odgovor na neka od ovih pitanja.</p>
<hr />
<p>Pogledajmo prvo stupce <code>t value</code> i <code>Pr(&gt;|t|)</code>, tj. njihove vrijednosti koje se tiču naše ulazne varijable <code>x</code>. Oni odgovaraju na pitanje - da li uopće imamo dovoljno dokaza za to da postoji linearna veza između ulaza i izlaza?</p>
<p>Odgovor na ovo pitanje daje tzv. <em>t - test</em>, tj. mjera jačine dokaza protiv nul-hipoteze koja tvrdi da linearna međuzavisnost ne postoji te da je koeficijent smjera pravca zapravo nula. Vrijednost pod <code>Pr(&gt;|t|)</code> je tzv. “p-vrijednost”, tj. procjena vjerojatnosti da je kolinearnost uočena slučajno, a ovdje vidimo da je ona iznimno mala. U interpretaciji nam pomaži i zvjezdice pored, čiji značaj je objašnjen u retku ispod, a koje pomažu da vizualno identificiramo koeficijente za koje smo relativno sigurni da imaju linearnu povezanost sa ciljnom varijablom.</p>
<p>Ako smo zadovoljni dokazom da koeficijent smjera nije nula, onda možemo pogledati i stupac <code>Std. Error</code> koji nam opisuje koliko smo “sigurni” u dobiveni koeficijent smjera. Ovdje koristimo isti princip kao i kod procjene sigurnosti u izračunati parametar slučajnog uzorka dobivenog iz neke populacije, tj. koristimo centralni teorem i smatramo da sa 95% sigurnošću možemo reći da je “stvarni” koeficijent u intervalu dvije standardne greške od dobivenog koeficijenta.</p>
<hr />
<p>Ono što nam je potencijalno najzanimljivije iz sažetka su informacije dane pod stavkama <code>Residual standard error</code> i <code>Adjusted R-squared</code>.</p>
<p>Prva mjera je tzv. “standardna greška reziduala”, tj. procjena koliko (prosječno!) model “promašuje” kod svojih predviđanja ciljne varijable. Iznos “prihvatljive” greške razlikovati će se ovisno o konkretnom scenariju. Ovdje moramo upozoriti na jednu čestu početničku grešku kod interpretacije ove vrijednosti - ova veličina nam opisuje koliko model promašuje gledano sve predikcije zajedno, ne koliko će “promašiti” neka odabrana predikcija. Ako odaberemo neku točno određenu obzervaciju i zanima nas gdje možemo očekivati “stvarnu” vrijednost, onda pored greške modela moramo uračunati i varijabilnost koja nije objašnjena modelom, tj. “raspršenje” točaka oko pravca regresije. Što je manja količina varijabilnosti objašnjena modelom, to će i predikcije biti “nesigurnije”.</p>
<p>Mjeru <code>R-squared</code> smo već spominjali (prefiks <code>Adjusted</code> ćemo objasniti kad budemo pričali o više ulaznih varijabli) a upravo ona daje procjenu koliko je varijabilnosti objašnjeno modelom. U idealnom slučaju naš model će imati malu grešku reziduala i visok “R kvadrat”, no u praksi često moramo za svaki pojedini scenarij procijeniti što smatramo “dovoljno dobrim” budući da statistika ne može dati egzaktan odgovor na to pitanje.</p>
<hr />
<p>Konačno, još neki detalji koji su dobiveni u sažetku su:</p>
<ul>
<li>“sažetak 5 brojeva” reziduala koji nam pomaže u procjeni razdiobe dobivenih grešaka</li>
<li>“F-statistika” nam govori kolike su šanse da nijedna od ulaznih varijabli ne utječe na izlaz (ova statistika ima više smisla za multiplu linearnu regresiju )</li>
</ul>
<hr />
<p>Kako upotrijebiti model za stvaranje novih predikcija?</p>
<p>U jeziku R u općenitom slučaju za to koristimo generičku metodu <code>predict</code> kojoj kao parametre šaljemo stvoreni prediktivni model i <strong>podatkovni okvir</strong> sa novim podacima, pri čemu moramo voditi računa da podatkovni okvir ima stupce koji odgovaraju očekivanim ulazima modela. Ako ovoj funkciji ne proslijedimo nove podatke, ona će vratiti niz predikcija vezanih uz trening skup (tj. isti rezultat koji bi nam dala funkcija <code>fitted.values</code>).</p>
<hr />
<p><strong>Zadatak 15.6 - stvaranje novih predikcija</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># sljedeći vektor prikazuje &quot;nove&quot; vrijednosti ulazne varijable `x`</span>
novi_x &lt;-<span class="st"> </span><span class="kw">c</span>(-<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">102</span>)

<span class="co"># stvorite i ispišite predikcije za gornji vektor pomoću </span>
<span class="co"># funkcije `predict` i linearnog modela `linMod` linearnog modela `linMod`</span>
<span class="co"># pripazite da nove podatke šaljete u obliku podatkovnog okvira</span>


<span class="co"># izračunajte predikcije &quot;ručno&quot;, korištenjem jednadžbe pravca</span>
<span class="co"># i dobivenih koeficijenata linearnog modela</span></code></pre></div>
<div class="fold s o">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># stvorite i ispišite predikcije za gornji vektor pomoću </span>
<span class="co"># funkcije `predict` i linearnog modela `linMod`</span>
<span class="co"># pripazite da nove podatke šaljete u obliku podatkovnog okvira</span>
<span class="kw">predict</span>(linMod, <span class="kw">data.frame</span>(<span class="dt">x =</span> novi_x))

<span class="co"># izračunajte predikcije &quot;ručno&quot;, korištenjem jednadžbe pravca</span>
<span class="co"># i dobivenih koeficijenata linearnog modela</span>
<span class="kw">coef</span>(linMod)[<span class="dv">1</span>] +<span class="st"> </span>novi_x *<span class="st"> </span><span class="kw">coef</span>(linMod)[<span class="dv">2</span>] </code></pre></div>
<pre><code>##         1         2         3         4 
##  26.74074  86.71835 246.65864 454.58101 
## [1]  26.74074  86.71835 246.65864 454.58101</code></pre>
</div>
<hr />
<p>Jedan od potencijalnih problema u radu s objektom klase <code>lm</code> jest ta što zahtjeva dosta dodatnog programiranja ako želimo provoditi neka dodatna istraživanja dobivenih rezultata, poglavito glede vizualizacija (koje su nam često prilično važne za ocjenu kvalitete modela i detekciju mogućih problema). Za izvlačenje korisnih informacija potreban je i poznavanje niza generičkih metoda, a rezultati koje oni daju često su minimalni - npr. funkcije <code>fitted.values</code> i <code>residuals</code> kao rezultat daju numeričke vektore koje onda moramo “ručno” organizirati u neki podatkovni okvir kako bi ih smisleno analizirali, vizualizirali uz pomoć paketa <code>ggplot2</code>.</p>
<p>Zbog svega toga za brži i učinkovitiji rad sa linearnim (ali i drugim prediktivnim) modelima preporučujemo paket <code>broom</code>, koji je nastao kao rezultat rada grupe programera između kojih je i poznati Hadley Wickham. Ovaj paket nudi niz funkcija za “uređivanje” stvorenih prediktivnih modela i njihovo uobličavanje u podatkovne strukture s kojima lako provodimo uobičajene aktivnosti nastavka analize.</p>
<hr />
<p>Ovdje ćemo spomenuti tri zgodne funkcije za rad sa linearnim modelima:</p>
<ul>
<li><code>tidy</code> - daje nam odgovor na pitanje “koji su rezultati modela (izračunati koeficijenti i sl.)?” u obliku podatkovnog okvira</li>
<li><code>glance</code> - daje nam odgovor na pitanje “koliko je dobar model” u obliku podatkovnog okvira od jednog retka</li>
<li><code>augment</code> - detaljni rezultati modela u obliku podatkovnog okvira (originalni podaci + predikcije, reziduali i sl.)</li>
</ul>
<hr />
<p><strong>Zadatak 15.7 - paket ‘broom’</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># primjenite funkciju `tidy` nad linearnim modelom `linMod`</span>
<span class="co"># rezultat ispišite na zaslon</span>

<span class="co"># primjenite funkciju `glance` nad linearnim modelom `linMod`</span>
<span class="co"># rezultat ispišite na zaslon</span>

<span class="co"># primjenite funkciju `augment` nad linearnim modelom `linMod`</span>
<span class="co"># rezultantni podatkovni okvir pohranite u varijablu `predikcije`</span>

<span class="co"># proučite prvih nekoliko redaka okvira `predikcije`</span></code></pre></div>
<div class="fold s o">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#library(broom)   # ako je potrebno</span>
<span class="kw">tidy</span>(linMod)
<span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">---------------</span><span class="ch">\n</span><span class="st">&quot;</span>)
<span class="kw">glance</span>(linMod)
<span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">---------------</span><span class="ch">\n</span><span class="st">&quot;</span>)
predikcije &lt;-<span class="st"> </span><span class="kw">augment</span>(linMod)
<span class="kw">head</span>(predikcije)</code></pre></div>
<pre><code>##          term  estimate  std.error statistic      p.value
## 1 (Intercept) 46.733280 5.26088548  8.883159 3.202135e-14
## 2           x  3.998507 0.09044818 44.207715 1.533464e-66
## 
## ---------------
##   r.squared adj.r.squared    sigma statistic      p.value df    logLik
## 1 0.9522492      0.951762 26.34952  1954.322 1.533464e-66  2 -468.0287
##        AIC     BIC deviance df.residual
## 1 942.0575 949.873 68041.13          98
## 
## ---------------
##          y1        x  .fitted  .se.fit     .resid       .hat   .sigma
## 1 391.34672 83.82621 381.9130 4.014303   9.433729 0.02320998 26.46726
## 2 253.65682 48.47617 240.5656 2.640358  13.091214 0.01004107 26.45128
## 3  84.10163 10.52281  88.8088 4.462635  -4.707166 0.02868384 26.48055
## 4 143.74748 33.37091 180.1671 3.049517 -36.419613 0.01339420 26.22204
## 5 295.44411 74.64829 345.2150 3.431574 -49.770875 0.01696061 25.98994
## 6 148.29385 36.65901 193.3146 2.911169 -45.020733 0.01220645 26.08258
##        .cooksd .std.resid
## 1 0.0015590635  0.3622514
## 2 0.0012645333  0.4993426
## 3 0.0004851317 -0.1812619
## 4 0.0131439110 -1.3915242
## 5 0.0313093962 -1.9050970
## 6 0.0182602564 -1.7191222</code></pre>
</div>
<hr />
<p>Uočite da nam metoda <code>augment</code> zapravo proširuje originalni podatkovni okvir nizom stupaca relevantnih za dobiveni linearni model. Ovdje nećemo objašnjavati sve dobivene stupce, no neki od njih su:</p>
<ul>
<li><code>.fitted</code> - predikcije dobivene iz modela</li>
<li><code>.se.fit</code> - standardna greška pojedine predikcije</li>
<li><code>.resid</code> - iznos reziduala, tj. greške</li>
<li><code>.std.resid</code> - reziduali standardizirani na interval [0,1]</li>
<li><code>.hat</code> - mjera “ekstremnosti” ulazne varijable ove obzervacije (engl. <em>leverage</em>)</li>
<li><code>.cooksd</code> - mjera “utjecajnosti” obzervacije (engl. <em>influential point</em>); radi se o obzervacijama koju imaju visoku “<em>leverage</em>” mjeru i visoki rezidual</li>
</ul>
<p>Metodu <code>augment</code> možemo koristiti i kao alternativu generičkoj metodi <code>predict</code> - samo joj moramo proslijediti nove podatke uz pomoć parametra <code>newdata</code>.</p>
<hr />
<p>Jedna od karakteristika dobrog linearnog modela jest normalno rasipanje reziduala oko izračunatog pravca. Neke od vizualizacijskih metoda provjere ovog kriterija su:</p>
<ul>
<li>stvaranje točkastog grafa sa predikcijama na osi <code>x</code> i (standardiziranim) rezidualima na osi <code>y</code></li>
<li>stvaranje grafa procjene gustoće razdiobe standardiziranih reziduala</li>
<li>stvaranje kvantil-kvantil grafa standardiziranih reziduala</li>
</ul>
<p>Razlog zašto radimo sa standardiziranim a ne “pravim” rezidualima jest lakša interpretacija, budući da nam standardizacija omogućuje doslovni prikaz standardnih devijacija na grafu.</p>
<hr />
<p><strong>Zadatak 15.8 - provjera ‘normalnosti’ reziduala</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># uz pomoć podatkovnog okvira `predikcije`</span>
<span class="co"># stvorite točkasti graf predikcija i std. reziduala</span>
<span class="co"># na grafu nacrtajte i horizontalnu liniju koja prolazi kroz nulu</span>

<span class="co"># stvorite kvantil-kvantil graf std. reziduala</span></code></pre></div>
<div class="fold s o">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#library(gridExtras)  # ako je potrebno</span>
g1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(predikcije, <span class="kw">aes</span>(.fitted, .std.resid)) +<span class="st"> </span><span class="kw">geom_point</span>() +
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>)
g2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(predikcije, <span class="kw">aes</span>(<span class="dt">sample =</span> .std.resid)) +<span class="st"> </span><span class="kw">geom_qq</span>()
<span class="kw">grid.arrange</span>(g1, g2, <span class="dt">ncol =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="osnoveR_files/figure-html/unnamed-chunk-531-1.png" width="672" /></p>
</div>
<hr />
<p>Graf sa predikcijama na osi <code>x</code> i rezidualima na osi <code>y</code> nam je posebno koristan kod uočavanja potencijalnih problema sa modelom. Ovdje nemamo mjesta detaljno obraditi moguće scenarije, uzroke mogućih problema i metode rješavanja, no možemo pružiti neke općenite naputke:</p>
<ul>
<li>reziduali moraju biti “normalno” raspršeni oko nule</li>
<li>bilo kakvi očiti uzorci predstavljaju indikaciju da trenutni linearni model možda nije pogodan te da bi trebalo razmotriti alternative kroz transformaciju ulaznih ili izlaznih varijabli, promjene formule, odabira kompleksnijeg modela i sl.</li>
<li>“iskačuće” vrijednosti se jasno vide u grafu reziduala te često zahtijevaju posebnu pažnju</li>
</ul>
<hr />
<p>Moramo biti oprezni ako radimo sa podacima zasnovanima na tzv. “vremenskim serijama” (engl. <em>time series data</em>). Kod takvih podataka greške će biti korelirane, što kao rezultat može imati činjenicu da model naizgled daje puno bolje rezultate nego što je to realno slučaj. Vremenske serije podataka zahtijevaju specijalizirane analitičke metode, koje ovdje nećemo posebno obrađivati. Bitno je samo znati kako uočiti da radimo nad vremenskom serijom podataka (ako toga nismo unaprijed svjesni poznavanjem domene) - trik je pogledati graf reziduala posloženih redoslijedom kako su poredane originalne obzervacije. Umjesto nasumično raspršenih reziduala kod vremenske serije vidjet ćemo jasni kontinuirani uzorak tj. greške koje “prate” jedna drugu i očito su jasno međusobno povezane. U ovom slučaju trebamo zanemariti rezultate analize i odabrati specijaliziranu metodu koja je prilagođena analizi ovakvog tipa podataka.</p>
<hr />
</div>
<div id="linearna-regresija-i-kategorijske-varijable" class="section level3">
<h3><span class="header-section-number">15.1.4</span> Linearna regresija i kategorijske varijable</h3>
<hr />
<p>U prethodnom poglavlju prikazali smo razvoj prediktivnog modela linearne regresije gdje je ulazna varijabla bila numeričkog tipa. Opravdano je zapitati se - može li kategorijska varijabla biti ulaz u prediktivni model?</p>
<p>Odgovor je - može, uz određenu prilagodbu. Prikažimo kako na jednostavnom primjeru dvorazinske kategorijske varijable, što kasnije lako proširujemo na varijable sa više od dvije kategorije.</p>
<p>Kategorijska varijabla prema svojoj prirodi ne može biti dio jednadžbe pravca, budući da kategorija sama po sebi nema numerički ekvivalent koji bi se mogao smisleno koristiti za izračun ciljne varijable. No ono što možemo učiniti jest pretvoriti kategorijsku varijablu u binarnu (indikatorsku) varijablu koja opisuje pripada li određena obzervacija odabranoj kategoriji (ako ne pripada, onda logično pripada onoj drugoj, referentnoj ili <em>baseline</em> kategoriji). Linearna regresija će potom odrediti koeficijent koji će definirati pravac na način da se koeficijent pribraja ako je indikatorska varijabla <code>1</code>, ili se ne uzima u obzir ako je indikatorska varijabla <code>0</code>.</p>
<hr />
<p>Za dvorazinsku kategorijsku varijablu dovoljna nam je dakle jedna indikatorska varijabla (druga bi bila komplement prve i ne bi nosila nikakvu dodatnu informaciju). Koliko nam treba indikatorskih varijabli za kategorijsku varijablu sa više od dvije kategorije? Odgovor je logičan - jedna manje od broja kategorija, budući da “nepripadanje” svim kategorijama osim jedne nužno označava pripadanje toj jednoj, preostaloj kategoriji.</p>
<p>U nastavku ćemo prikazati linearnu regresiju sa dvorazinskom kategorijskom varijablom, budući da se radi o inačici jednostavne linearne regresije. Za veći broj kategorija problem se svodi na višestruku linearnu regresiju koju ćemo obrađivati nakon ovog poglavlja.</p>
<p>Učitajmo sada novi, također umjetno stvoreni podatkovni okvir, sa jednom dvorazinskom kategorijskom varijablom <code>x</code> koja predstavlja ulaz te ciljnom numeričkom varijablom <code>y</code>.</p>
<hr />
<p><strong>Zadatak 15.9 - kategorijska ulazna varijabla</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># u varijablu `df` učitajte podatke iz datoteke `podaci2.csv`</span>
<span class="co"># proučite učitani podatkovni okvir</span>

<span class="co"># nacrtajte točkasti graf ovisnosti varijable `y` o varijabli `x`</span></code></pre></div>
<div class="fold s o">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># u varijablu `df` učitajte podatke iz datoteke `podaci2.csv`</span>
<span class="co"># proučite učitani podatkovni okvir</span>
df &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;podaci2.csv&quot;</span>)
<span class="kw">glimpse</span>(df)</code></pre></div>
<pre><code>## Observations: 100
## Variables: 2
## $ x &lt;fctr&gt; B, B, A, B, B, B, A, A, A, B, B, A, A, B, B, B, B, B, A, B,...
## $ y &lt;dbl&gt; 63.61392, 63.91110, 20.24407, 95.70271, 56.93969, 78.36473, ...</code></pre>
</div>
<div class="fold s o">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># nacrtajte točkasti graf ovisnosti varijable `y` o varijabli `x`</span>
<span class="kw">ggplot</span>(df, <span class="kw">aes</span>(x, y)) +<span class="st"> </span><span class="kw">geom_point</span>() </code></pre></div>
<p><img src="osnoveR_files/figure-html/unnamed-chunk-536-1.png" width="672" /></p>
</div>
<hr />
<p>Vidimo da je razdioba ciljne varijable različita za različite kategorije ulazne varijable. Ovaj porast možemo modelirati linearnom regresijom, iako će interpretacija modela biti nešto drugačija s obzirom na intepretaciju numeričkih ulaza, kako ćemo vidjeti nakon izgradnje samog modela.</p>
<p>Jedna od prednosti korištenja faktorskih varijabli u jeziku R jest ta što kod treniranja linearnih modela ne moramo “ručno” stvarati indikatorske varijable. Mi samo trebamo staviti faktore kao ulazne varijable u formulu za treniranje modela, a R će automatski stvoriti indikatorske varijable za nas (ovo vrijedi i za stvaranje predikcija jednom kad je model stvoren - pod uvjetom da faktori u novim podacima ne sadržavaju “nepoznate” kategorije).</p>
<hr />
<p><strong>Zadatak 15.10 - stvaranje linearnog modela sa kategorijskim ulazom</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># uz pomoć funkcije `lm` stvorite linearni model podataka iz tablice `df`</span>
<span class="co"># gdje je `x` ulazna a `y` izlazna varijabla</span>
<span class="co"># rezultat spremite u varijablu `linMod`</span></code></pre></div>
<div class="fold s o">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">linMod &lt;-<span class="st"> </span><span class="kw">lm</span>(y ~<span class="st"> </span>x, <span class="dt">data =</span> df)
<span class="kw">summary</span>(linMod)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x, data = df)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -19.206  -6.104  -1.367   5.523  28.665 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   20.493      1.398   14.66   &lt;2e-16 ***
## xB            55.652      1.938   28.71   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 9.684 on 98 degrees of freedom
## Multiple R-squared:  0.8938, Adjusted R-squared:  0.8927 
## F-statistic: 824.4 on 1 and 98 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<p>Vidimo da je sažetak linearnog modela vrlo sličan već prikazanom sažetku gdje je ulazna varijabla bila numeričkog tipa. Razlika u interpretaciji je sljedeća - koeficijent smjera veže se uz konkretnu kategoriju (navedenu uz ime varijable), a tiče se očekivane razlike u iznosu ciljne varijable kad obzervacija ima navedenu kategoriju, u odnosu na referentnu kategoriju.</p>
<p>Za kraj ovog dijela naglasimo samo da je kod korištenja kategorijskih varijabli kao ulaze u linearni model bitno voditi računa o zastupljenosti kategorija, tj. da nemamo kategorije koje su vrlo slabo zastupljene u podatkovnom skupu za treniranje. Razlog je taj što ovakve obzervacije vrlo često imaju veliki utjecaj na regresijski pravac, a što može imati nepovoljne posljedice na kvalitetu linearnog modela.</p>
<hr />
</div>
</div>
<div id="visestruka-multipla-linearna-regresija" class="section level2">
<h2><span class="header-section-number">15.2</span> Višestruka (multipla) linearna regresija</h2>
<hr />
<p>Princip jednostavne linearne regresije lako se proširuje na scenarij kada imamo više ulaznih varijabli - jednostavno rečeno, tražimo funkciju koja će ciljnu varijablu izraziti kao linearnu kombinaciju ulaznih varijabli. Problem izgradnje modela opet se svodi na traženje “dobrih” koeficijenata smjera koji će ići uz svaku ulaznu varijablu (plus odsječak), iako formalno sada ne možemo pričati o “pravcu” regresije već se radi o nešto kompleksnijem pojmu “hiper-ravnine”.</p>
<p>Kod višestruke linearne regresije pojavljuje se niz dodatnih izazova s kojima se moramo suočiti, no za samo treniranje modela koristimo već upoznatu funkciju <code>lm</code>, kojoj je dovoljno proslijediti željenu formulu, npr:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y ~<span class="st"> </span>x1 +<span class="st"> </span>x2              <span class="co"># `y` kao linearna kombinacija `x1` i `x2`</span>
y ~<span class="st"> </span>.                    <span class="co"># `y` kao linearna kombinacija svih ostalih varijabli</span>
y ~<span class="st"> </span>. -<span class="st"> </span>x1 -<span class="st"> </span>x2          <span class="co"># `y` kao linearna kombinacija svih ostalih varijabli OSIM x1 i x2</span>
<span class="kw">log</span>(y)  ~<span class="st"> </span>x1 +<span class="st"> </span><span class="kw">log</span>(x2)   <span class="co">#  prirodni logaritam od `y` kao linearna kombinacija `x1` i</span>
                              <span class="co"># prirodnog logaritma od `x2`</span>
y ~<span class="st"> </span>x1 +<span class="st"> </span><span class="kw">I</span>(x2^<span class="dv">2</span>)         <span class="co"># `y` kao linearna kombinacija `x1` i kvadrata od `x2`</span></code></pre></div>
<p>Uočimo da formula može sadržavati i transformirane ulaze (i izlaze!). Ovdje moramo biti u izvjesnoj mjeri oprezni jer se ponekad matematička notacija “sukobljava” sa notacijom formule (npr. vidimo da <code>-</code> zapravo nije aritmetičko oduzimanje već metoda određivanja nepoželjne varijable). Zbog toga smo u zadnjem primjeru koristili funkciju <code>I</code>, koja jednostavno označava da se izraz između zagrada treba tretirati “onakav kakav je”.</p>
<p>Prikazanim transformacijama ulaza i izlaza udaljavamo se od jednostavnijih modela linearne regresije sa više ulaza tako da ih u nastavku nećemo koristiti. Ovdje ih navodimo samo iz razloga potpunosti te kao motivaciju za isprobavanje složenijih regresijskih formula u situacijama kada se ukaže potreba za takvim pristupom.</p>
<p>Pokušajmo sada stvoriti prediktivni model sa više ulaznih varijabli. U zadatku ćemo koristiti otprije upoznati podatkovni skup <code>mtcars</code> (ako je potrebno podsjetite se dodatnih detalja o ovom skupu uz pomoć dokumentacije).</p>
<hr />
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(mtcars)
<span class="co"># faktoriziramo stupce  `vs` i `am`</span>
cols &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;vs&quot;</span>, <span class="st">&quot;am&quot;</span>)
mtcars[, cols] &lt;-<span class="st"> </span><span class="kw">lapply</span>(mtcars[, cols], factor)

<span class="kw">glimpse</span>(mtcars)</code></pre></div>
<pre><code>## Observations: 32
## Variables: 11
## $ mpg  &lt;dbl&gt; 21.0, 21.0, 22.8, 21.4, 18.7, 18.1, 14.3, 24.4, 22.8, 19....
## $ cyl  &lt;dbl&gt; 6, 6, 4, 6, 8, 6, 8, 4, 4, 6, 6, 8, 8, 8, 8, 8, 8, 4, 4, ...
## $ disp &lt;dbl&gt; 160.0, 160.0, 108.0, 258.0, 360.0, 225.0, 360.0, 146.7, 1...
## $ hp   &lt;dbl&gt; 110, 110, 93, 110, 175, 105, 245, 62, 95, 123, 123, 180, ...
## $ drat &lt;dbl&gt; 3.90, 3.90, 3.85, 3.08, 3.15, 2.76, 3.21, 3.69, 3.92, 3.9...
## $ wt   &lt;dbl&gt; 2.620, 2.875, 2.320, 3.215, 3.440, 3.460, 3.570, 3.190, 3...
## $ qsec &lt;dbl&gt; 16.46, 17.02, 18.61, 19.44, 17.02, 20.22, 15.84, 20.00, 2...
## $ vs   &lt;fctr&gt; 0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1,...
## $ am   &lt;fctr&gt; 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1,...
## $ gear &lt;dbl&gt; 4, 4, 4, 3, 3, 3, 3, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 4, 4, ...
## $ carb &lt;dbl&gt; 4, 4, 1, 1, 2, 1, 4, 2, 2, 4, 4, 3, 3, 3, 4, 4, 4, 1, 2, ...</code></pre>
<hr />
<p><strong>Zadatak 15.11 - stvaranje linearnog modela sa vie ulaza</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># uz pomoć funkcije `lm` stvorite linearni model podataka iz tablice `mtcars`</span>
<span class="co"># koristite varijable `am`,  `cyl` i `wt` kao ulaz</span>
<span class="co"># i varijablu `mpg` kao izlaz</span>
<span class="co">#</span>
<span class="co"># proučite sažetak modela</span></code></pre></div>
<div class="fold s o">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">linMod &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg ~<span class="st"> </span>am +<span class="st"> </span>cyl +<span class="st"> </span>wt, <span class="dt">data =</span> mtcars)
<span class="kw">summary</span>(linMod)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mpg ~ am + cyl + wt, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.1735 -1.5340 -0.5386  1.5864  6.0812 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  39.4179     2.6415  14.923 7.42e-15 ***
## am1           0.1765     1.3045   0.135  0.89334    
## cyl          -1.5102     0.4223  -3.576  0.00129 ** 
## wt           -3.1251     0.9109  -3.431  0.00189 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.612 on 28 degrees of freedom
## Multiple R-squared:  0.8303, Adjusted R-squared:  0.8122 
## F-statistic: 45.68 on 3 and 28 DF,  p-value: 6.51e-11</code></pre>
</div>
<hr />
<p>Vidimo da se niti ovaj sažetak naizgled ne razlikuje od sažetaka koje smo viđali kada smo radili jednostavne linearne modele. Najveća razlika jest u tome što je svaka ulazna numerička varijabla dobija svoj pripadajući koeficijent, kao i svaka kategorija osim referentne za svaku pojedinu kategorijsku varijablu. Isto tako, svaki koeficijent ima svoju vlastitu “p-vrijednost” tj. vjerojatnost da je linearni odnos sa ciljnom varijablom slučajan - tako u ovom slučaju zbog visoke p-vrijednosti ulazne varijable <code>am</code> (kategorija <code>1</code>) možemo zaključiti je razlika između automatskog i ručnog mjenjača vrlo vjerojatno nebitna kad gledamo potrošnju automobila (što nije neobičan zaključak).</p>
<p>No postoji i nekoliko bitnih razlika u interpretaciji dobivenih rezultata. Tako recimo koeficijent predstavlja pomak ciljne varijable za jednu jedinicu ulazne varijable, <em>ali pod uvjetom da svi ostali ulazni parametri ostaju fiksni</em>. Drugim riječima, koeficijenti se tretiraju kao da su nezavisni jedni od drugih (što često nije slučaj, a o čemu će više riječi biti kasnije).</p>
<hr />
<p>Nadalje, iako “R-kvadrat” vrijednost ima svoju inačicu za višestruku regresiju, ona može biti ponešto problematična zbog činjenice da se višestruka R-kvadrat vrijednost u pravilu uvijek smanjuje kako dodajemo varijable u model. Zbog toga kod višestruke regresije gledamo <strong>prilagođenu</strong> R-kvadrat vrijednost (engl. <em>adjusted R-squared</em>) koja to kompenzira, tj. koja penalizira veći broj varijabli.</p>
<p>Konačno, F-statistika ovdje ima više smisla nego u modelu jednostavne regresije. Ona nam govori kolika je šansa da nijedna ulazna varijabla nije povezana sa ciljnom. Ovo pogotovo postaje važno što više ulaznih varijabli koristimo, budući da kod velikog broja varijabli mogućnost slučajnog uočavanja nepostojećeg odnosa postaje puno više vjerojatno.</p>
<hr />
<p>Vratimo se navedenoj tvrdnji da koeficijenti višestruke linearne regresije tretiraju ulazne varijable kao da su nezavisne jedna od druge. To relativno često nije slučaj tj. ulazne varijable nisu samo kolinearne sa ciljem, nego i između sebe. Ovo je poznati problem <em>kolinearnosti ulaznih varijabli</em>.</p>
<p>Ako možda nije odmah jasno zašto je ovo problematično, dovoljno je ponovo pogledati interpretaciju koeficijenata višestruke linearne regresije. Pretpostavka da se jedan ulazni parametar mijenja dok njemu kolinearan ostaje fiksan je nerealan, što se odražava u podatkovnom skupu a samim time i u porastu “nesigurnosti” linearnog modela. Zbog toga u konačnom rezultatu modela možemo dobiti veće p-vrijednosti ulaznih varijabli, tj. one mogu biti tretirane kao irelevantne, iako su zapravo snažno linearno povezane s ciljem.</p>
<p>Kolinearnost ulaznih varijabli možemo provjeriti uz pomoć već korištene funkcije <code>cor</code>, koja će nam kao rezultat dati korelacijsku matricu. Čvrste granice što predstavlja “previsoku” kolinearnost nema, ali vrijednosti koje su po apsolutnom iznosu iznad 0.7 vjerojatno zaslužuju posebnu pažnju. Alternativno, možemo pozvati funkciju <code>ggpairs</code> koja će nam dati iznose koeficijenta korelacije, ali i vizualizacije pomoću kojih možemo uočiti linearne trendove između ulaznih varijabli.</p>
<hr />
<p><strong>Zadatak 15.12 - kolinearnost ulaznih varijabli</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># u podatkovni okvir `mtcarsNumInputs` ubacite sve numeričke</span>
<span class="co"># varijable podatkovnog okvira `mtcars` osim ciljne varijable `mpg`</span>

<span class="co"># uz pomoć funkcije `cor` ispišite korelacijsku matricu</span>
<span class="co"># numeričkih stupaca okvira `mtcarsNumInputs`</span>

<span class="co"># proslijedite taj okvir funkciji `ggpairs` paketa `GGally`</span></code></pre></div>
<div class="fold s o">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mtcarsNumInputs &lt;-<span class="st"> </span>mtcars[, <span class="kw">sapply</span>(mtcars, is.numeric)]
mtcarsNumInputs &lt;-<span class="st"> </span><span class="kw">select</span>(mtcarsNumInputs, -mpg)

<span class="kw">cor</span>(mtcarsNumInputs)</code></pre></div>
<pre><code>##             cyl       disp         hp        drat         wt        qsec
## cyl   1.0000000  0.9020329  0.8324475 -0.69993811  0.7824958 -0.59124207
## disp  0.9020329  1.0000000  0.7909486 -0.71021393  0.8879799 -0.43369788
## hp    0.8324475  0.7909486  1.0000000 -0.44875912  0.6587479 -0.70822339
## drat -0.6999381 -0.7102139 -0.4487591  1.00000000 -0.7124406  0.09120476
## wt    0.7824958  0.8879799  0.6587479 -0.71244065  1.0000000 -0.17471588
## qsec -0.5912421 -0.4336979 -0.7082234  0.09120476 -0.1747159  1.00000000
## gear -0.4926866 -0.5555692 -0.1257043  0.69961013 -0.5832870 -0.21268223
## carb  0.5269883  0.3949769  0.7498125 -0.09078980  0.4276059 -0.65624923
##            gear       carb
## cyl  -0.4926866  0.5269883
## disp -0.5555692  0.3949769
## hp   -0.1257043  0.7498125
## drat  0.6996101 -0.0907898
## wt   -0.5832870  0.4276059
## qsec -0.2126822 -0.6562492
## gear  1.0000000  0.2740728
## carb  0.2740728  1.0000000</code></pre>
</div>
<div class="fold s o">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#library(GGally) # ukoliko je potrebno</span>
<span class="kw">ggpairs</span>(mtcarsNumInputs)</code></pre></div>
<p><img src="osnoveR_files/figure-html/unnamed-chunk-545-1.png" width="672" /></p>
</div>
<hr />
<p>Vidimo da neke varijable (npr. <code>disp</code> i <code>wt</code>, koje predstavljaju volumen motora i težinu vozila) imaju vrlo visoku razinu kolinearnosti, što znači da zahtijevaju posebnu pažnju.</p>
<p>Kolinearnost varijabli koju smo gledali tiče se parova varijablu, no moguća je i jedna interesantna pojava - tzv. <em>multikolinearnost</em>. Kod ove pojave moguće je da se kolinearnost očituje tek u kombinaciji tri i više varijabli, tj. kod gledanja zasebnih parova ne vidimo ništa neobično ali negativni učinak kolinearnosti i dalje postoji.</p>
<p>Kako bi se olakšalo uočavanje ove pojave, razvijena je tzv. VIF mjera (engl. <em>variance inflation factor</em>). Ovdje nećemo detaljno objašnjavati značenje i teoriju iza ove mjere, nego samo navesti činjenicu kako ju upotrijebiti u našem linearnom modelu te kako interpretirati dobivene vrijednosti.</p>
<p>VIF mjeru izračunavamo uz pomoć funkcije <code>vif</code> koju možemo naći u paketu <code>car</code>. Ova funkcija kao parametar očekuje linearni model kojeg analiziramo. Kao rezultat dobivamo numerički vektor sa VIF vrijednostima svake ulazne varijable. Opet, nema egzaktne granice što predstavlja “visoku” VIF vrijednost - u literaturi nailazimo na različite naputke, a kao granica se spominje vrijednost 5, vrijednost 10 i sl. Kao općenito pravilo možemo zapamtiti da dvoznamenkasti VIF označava “problematičnu” ulaznu varijablu.</p>
<hr />
<p><strong>Zadatak 15.13 - multikolinearnost</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># istrenirajte linearni model `lm_sve` koja za okvir `mtcars`</span>
<span class="co"># gleda ovisnost varijable `mpg` o svim ostalim varijablama</span>
<span class="co">#</span>
<span class="co"># navedeni model proslijedite funkciji `vif` paketa `cars` i ispišite rezultat</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#library(car)  # ako je potrebno</span>
lm_sve &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg ~<span class="st"> </span>., <span class="dt">data =</span> mtcars)
<span class="kw">vif</span>(lm_sve)</code></pre></div>
<pre><code>##       cyl      disp        hp      drat        wt      qsec        vs 
## 15.373833 21.620241  9.832037  3.374620 15.164887  7.527958  4.965873 
##        am      gear      carb 
##  4.648487  5.357452  7.908747</code></pre>
<hr />
<p>Sad kada znamo da je kolinearnost ulaznih varijabli potencijalni problem, možemo postaviti pitanje - što učiniti kada uočimo navedenu pojavu? Neke od mogućih rješenja su:</p>
<ul>
<li>izbaciti jednu od para problematičnih varijabli</li>
<li>transformirati kolinearne varijable u alternativnu jedinstvenu ulaznu varijablu</li>
</ul>
<hr />
<p><strong>Zadatak 15.14 - linearni model sa kolinearnim ulazima</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># trenirajte sljedeće linearne modele:</span>
<span class="co">#  `lm1` - `mpg` u ovisnosti o `disp`</span>
<span class="co">#  `lm2` - `mpg` u ovisnosti o `wt`</span>
<span class="co">#  `lm3` - `mpg` u ovisnosti o `disp` i `wt`</span>

<span class="co"># proučite sažetke dobivenih linearnih modela,</span>
<span class="co"># poglavito t-vrijednosti parametara i prilagođenu R-kvadrat mjeru</span></code></pre></div>
<div class="fold s o">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lm1 &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg ~<span class="st"> </span>disp, <span class="dt">data =</span> mtcars)
lm2 &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg ~<span class="st"> </span>wt, <span class="dt">data =</span> mtcars)
lm3 &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg ~<span class="st"> </span>disp +<span class="st"> </span>wt, <span class="dt">data =</span> mtcars)</code></pre></div>
</div>
<div class="fold s o">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(lm1)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mpg ~ disp, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.8922 -2.2022 -0.9631  1.6272  7.2305 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 29.599855   1.229720  24.070  &lt; 2e-16 ***
## disp        -0.041215   0.004712  -8.747 9.38e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.251 on 30 degrees of freedom
## Multiple R-squared:  0.7183, Adjusted R-squared:  0.709 
## F-statistic: 76.51 on 1 and 30 DF,  p-value: 9.38e-10</code></pre>
</div>
<div class="fold s o">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(lm2)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mpg ~ wt, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.5432 -2.3647 -0.1252  1.4096  6.8727 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  37.2851     1.8776  19.858  &lt; 2e-16 ***
## wt           -5.3445     0.5591  -9.559 1.29e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.046 on 30 degrees of freedom
## Multiple R-squared:  0.7528, Adjusted R-squared:  0.7446 
## F-statistic: 91.38 on 1 and 30 DF,  p-value: 1.294e-10</code></pre>
</div>
<div class="fold s o">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(lm3)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mpg ~ disp + wt, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.4087 -2.3243 -0.7683  1.7721  6.3484 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 34.96055    2.16454  16.151 4.91e-16 ***
## disp        -0.01773    0.00919  -1.929  0.06362 .  
## wt          -3.35082    1.16413  -2.878  0.00743 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.917 on 29 degrees of freedom
## Multiple R-squared:  0.7809, Adjusted R-squared:  0.7658 
## F-statistic: 51.69 on 2 and 29 DF,  p-value: 2.744e-10</code></pre>
</div>
<hr />
<p>Usporedivši rezultate dobivenih linearnih modela možemo zaključiti kako linearni model <code>lm3</code> ima najmanju standardnu grešku reziduala i najveću “R-kvadrat” mjeru te je time najbolja od tri opcije. No potencijalni problem se očituje kada pogledamo p-vrijednosti, koje su obje znatno veće nego kada smo trenirali modele sa svakom varijablom zasebno. Dakle, kolinearnost varijabli ne mora nužno utjecati na prediktivnu moć modela, ali unosi potencijalno veliku nesigurnost u modelu smislu da sve kolinearne prediktore izbacimo iz modela kao irelevantne. To bi se mogao pokazati kao velik problem kada imamo više potencijalnih prediktora i pokušavamo odabrati relevantni podskup, što je tema kojom ćemo se baviti u nastavku.</p>
<hr />
<p>U prethodnom zadatku vidjeli smo kako se i kod relativno jednostavne prediktivne metode višestruke regresije sa dvije potencijalne ulazne varijable pojavljuje niz pitanja vezanih uz odabir formule tj. ulaznih varijabli. Ova problematika se višestruko komplicira kako broj potencijalnih ulaznih varijabli raste. Zbog toga je odabir varijabli (<em>variable selection</em>) jedan od ključnih izazova s kojima se suočavamo u izradi prediktivnih modela, ne samo kod linearne regresije već i općenito.</p>
<p>Očito je da bi dobar model trebao sadržavati ulazne varijable koje dobro “objašnjavaju” ciljnu varijablu a koje su što više međusobno nezavisne. Mogući kriterij za odluku koje varijablu odabrati za ugrađivanje u model tako može biti utjecaj na povećanje zajedničke “R-kvadrat” mjere, smanjenje standardne greške reziduala ili p-vrijednost koeficijenta za tu ulaznu varijablu. Pored ovih “standardnih” kriterija postoje i razni drugi, kao npr. popularni AIC (engl. <em>Akaike information criterion</em>) koji procjenjuje informativnost modela uz penaliziranje većeg broj varijabli.</p>
<hr />
<p>Varijable možemo odabirati ručno, no puno je lakše taj posao ostaviti računalu. Statistički alati, uključujući i jezik R, često imaju ugrađene algoritme koji na osnovu zadanog kriterija izgrađuju prediktivni model iterativnim odabirom varijabli. Najčešće strategije izgradnje modela su:</p>
<ul>
<li>“unatrag” od potpunog modela, npr. iterativno se izbacuju varijable sa najvećom p-vrijednosti</li>
<li>“unaprijed” od praznog modela, npr. iterativno se dodaju varijable koje najviše smanjuju RSME</li>
<li>razne hibridne metode</li>
</ul>
<hr />
<p>Jezik R ima funkciju <code>step</code> za iterativno (engl. <em>stepwise</em>) stvaranje prediktivnih modela, no u praksi se preporučuje puno bolja funkcija <code>stepAIC</code> koju možemo naći u paketu <code>MASS</code>. Ova funkcija između ostalog očekuje sljedeće parametre:</p>
<ul>
<li><code>object</code> - inicijalni (linearni) model</li>
<li><code>scope</code> - raspon modela koje uključujemo u strategiju; potreban je samo za izgradnju “unaprijed” a prosljeđujemo joj listu sa “najsiromašnijim” (<code>lower</code>) i “najbogatijim” (<code>upper</code>) modelom</li>
<li><code>direction</code> - unaprijed (<code>forward</code>), unatrag (<code>backward</code>) ili hibridno (<code>both</code>)</li>
<li><code>trace</code> - binarna varijabla koja opisuje želimo li ispis cijelog procesa odabira varijabli</li>
</ul>
<p>(Napomena: paket <code>MASS</code> ima “svoju” funkciju <code>select</code> koja može “prekriti” funkciju <code>select</code> iz paketa <code>dplyr</code>; ovo ne znači da je ta funkcija nedostupna, već da ju nakon učitavanja paketa <code>MASS</code> moramo pozivati sa njenim “punim” imenom, <code>dplyr::select</code>)</p>
<p>Za kraj ćemo iterativno stvoriti prediktivni model za podatkovni okvir <code>mtcars</code> gdje će opet ciljna varijabla biti potrošnja (varijabla <code>mpg</code>) dok će kandidati za ulaznu varijablu biti sve ostale varijable.</p>
<hr />
<p><strong>Zadatak 15.15 - iterativna selekcija varijabli za linearnu regresiju</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#library(MASS) # ako je potrebno</span>

<span class="co"># stvaramo &quot;potpuni&quot; i &quot;prazni&quot; model </span>
lm_sve &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg ~<span class="st"> </span>., <span class="dt">data =</span> mtcars)   
lm_prazan &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg ~<span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> mtcars)

<span class="co"># pogledajte sažetke gornjih modela kako bi </span>
<span class="co"># dobili dojam kako rade &quot;ekstremi&quot;</span>

<span class="co"># uz pomoć funkcije `stepAIC` stvorite modele `lm1` i `lm2` </span>
<span class="co"># na sljedeći način</span>
<span class="co"># `lm1` - nastaje selekcijom &quot;unatrag&quot; od punog modela</span>
<span class="co">#         (parametar direction = &quot;backward&quot;)</span>
<span class="co"># `lm2` - nastaje selekcijom &quot;unaprijed&quot; od praznog modela</span>
<span class="co">#         (parametri direction = &quot;forward&quot; , </span>
<span class="co">#         scope = list(upper = lm_sve, lower = lm_prazan))</span>
<span class="co">#</span>
<span class="co"># proučite sažetke dobivenih modela</span></code></pre></div>
<div class="fold s o">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(lm_sve)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mpg ~ ., data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.4506 -1.6044 -0.1196  1.2193  4.6271 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept) 12.30337   18.71788   0.657   0.5181  
## cyl         -0.11144    1.04502  -0.107   0.9161  
## disp         0.01334    0.01786   0.747   0.4635  
## hp          -0.02148    0.02177  -0.987   0.3350  
## drat         0.78711    1.63537   0.481   0.6353  
## wt          -3.71530    1.89441  -1.961   0.0633 .
## qsec         0.82104    0.73084   1.123   0.2739  
## vs1          0.31776    2.10451   0.151   0.8814  
## am1          2.52023    2.05665   1.225   0.2340  
## gear         0.65541    1.49326   0.439   0.6652  
## carb        -0.19942    0.82875  -0.241   0.8122  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.65 on 21 degrees of freedom
## Multiple R-squared:  0.869,  Adjusted R-squared:  0.8066 
## F-statistic: 13.93 on 10 and 21 DF,  p-value: 3.793e-07</code></pre>
</div>
<div class="fold s o">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(lm_prazan)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mpg ~ 1, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -9.6906 -4.6656 -0.8906  2.7094 13.8094 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   20.091      1.065   18.86   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6.027 on 31 degrees of freedom</code></pre>
</div>
<div class="fold s o">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lm1 &lt;-<span class="st"> </span><span class="kw">stepAIC</span>(lm_sve, <span class="dt">direction=</span><span class="st">&quot;backward&quot;</span>, <span class="dt">trace =</span> <span class="dv">0</span>) 
<span class="kw">summary</span>(lm1)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mpg ~ wt + qsec + am, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.4811 -1.5555 -0.7257  1.4110  4.6610 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   9.6178     6.9596   1.382 0.177915    
## wt           -3.9165     0.7112  -5.507 6.95e-06 ***
## qsec          1.2259     0.2887   4.247 0.000216 ***
## am1           2.9358     1.4109   2.081 0.046716 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.459 on 28 degrees of freedom
## Multiple R-squared:  0.8497, Adjusted R-squared:  0.8336 
## F-statistic: 52.75 on 3 and 28 DF,  p-value: 1.21e-11</code></pre>
</div>
<div class="fold s o">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lm2 &lt;-<span class="st"> </span><span class="kw">stepAIC</span>(lm_prazan, <span class="dt">scope =</span> <span class="kw">list</span>(<span class="dt">upper =</span> lm_sve, <span class="dt">lower =</span> lm_prazan), 
                <span class="dt">direction=</span><span class="st">&quot;forward&quot;</span>, <span class="dt">trace =</span> <span class="dv">0</span>)
<span class="kw">summary</span>(lm2)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mpg ~ wt + cyl + hp, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.9290 -1.5598 -0.5311  1.1850  5.8986 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 38.75179    1.78686  21.687  &lt; 2e-16 ***
## wt          -3.16697    0.74058  -4.276 0.000199 ***
## cyl         -0.94162    0.55092  -1.709 0.098480 .  
## hp          -0.01804    0.01188  -1.519 0.140015    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.512 on 28 degrees of freedom
## Multiple R-squared:  0.8431, Adjusted R-squared:  0.8263 
## F-statistic: 50.17 on 3 and 28 DF,  p-value: 2.184e-11</code></pre>
</div>
<hr />
<p>Vidimo da su dvije strategije rezultirale sa dva potpuno različita modela sličnih performansi. To znači da ne možemo očekivati pronalazak optimalnog modela, već samo automatizirani pokušaj pronalaska “najboljeg” uz kriterije i uvjete koje smo inicijalno postavili. Ukoliko nismo zadovoljni rezultatom, uvijek možemo pokušati sa alternativnim parametrima funkcije, drugom strategijom ili inicijalnim skupom ulaznih varijabli. U svakom slučaju, pronalazak zadovoljavajućeg prediktivnog modela nije jednostavan problem, a uvijek je poželjno sjetiti se citata koji se često pronalazi u knjigama o statistici i strojnom učenju, a kojeg je navodno izrekao statističar George Box - “Svi modeli su pogrešni, ali neki su korisni”.</p>
<hr />
<p><a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png" /></a><br /><span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">Programirajmo u R-u</span> by <a xmlns:cc="http://creativecommons.org/ns#" href="https://www.fer.unizg.hr/en/damir.pintar" property="cc:attributionName" rel="cc:attributionURL">Damir Pintar</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/">Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License</a>.<br />Based on a work at <a xmlns:dct="http://purl.org/dc/terms/" href="https://ratnip.github.io/FER_OPJR/" rel="dct:source">https://ratnip.github.io/FER_OPJR/</a></p>

<div id="refs" class="references">
<div>
<p>Bache, Stefan Milton, and Hadley Wickham. 2014. <em>Magrittr: A Forward-Pipe Operator for R</em>. <a href="https://CRAN.R-project.org/package=magrittr" class="uri">https://CRAN.R-project.org/package=magrittr</a>.</p>
</div>
<div>
<p>Diez, D.M., C.D. Barr, and M. Çetinkaya-Rundel. 2015. <em>OpenIntro Statistics</em>. OpenIntro, Incorporated. <a href="https://books.google.hr/books?id=xNMWswEACAAJ" class="uri">https://books.google.hr/books?id=xNMWswEACAAJ</a>.</p>
</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="deskriptivna.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>


<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["osnoveR.pdf"],
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed",
"edit": null,
"download": null,
"search": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
